<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>

        "use strict";

        const TARGET_PHRASE = "To be or not to be.";
        const GENES = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ 1234567890,.-;:!?&'/()";
        const INDIVIDUAL_SIZE = TARGET_PHRASE.length;
        const POPULATION_SIZE = 100;
        const MUTATION_CHANCE = 0.01;

        console.log(GENES.length);

        const population = [];

        function getRandomChar(genes) {
            const randomNumber = Math.random();
            const randomCharIndex = Math.floor(randomNumber * genes.length);
            const randomChar = genes.charAt(randomCharIndex);
            return randomChar;
        }

        function createPopulation(populationSize) {
            do {
                let phrase = "";
                for(let i = 0 ; i < INDIVIDUAL_SIZE ; i++) {
                    const randomChar = getRandomChar(GENES);
                    phrase += randomChar;
                }
                const individual = {
                    "phrase" : phrase,
                    "fitness" : 0
                }
                population.push(individual);
            } while(population.length < populationSize);
            console.log(population);
        }

        function testPopulation() {
            population.forEach(individual => {
                let fitness = 0;
                for(let charIndex = 0; charIndex < INDIVIDUAL_SIZE; charIndex++) {
                    
                    if(individual.phrase[charIndex] === TARGET_PHRASE[charIndex]) {
                        fitness++
                    }
                }
                individual.fitness = fitness;
            });
        }

        function selection() {

            const sortedPopulation = population.sort((a, b) => b.fitness - a.fitness);

            const newPopulation = [];


            const parentA = tournamentSelection();
            const parentB = tournamentSelection();

            const childPhrase = recombination(parentA, parentB);



            console.log(parentA, parentB);
            console.log(childPhrase);
        }

        function tournamentSelection() {
            
            const numTournamentParticipants = 10;

            const participants = [];
            
            for(let i = 0; i < numTournamentParticipants; i++) {
                const randomNumber = Math.random();
                const randomPopulationIndex = Math.floor(randomNumber * POPULATION_SIZE);
                const randomIndividual = population[randomPopulationIndex];
                participants.push(randomIndividual);
            }

            const sortedParticipants = participants.sort((a, b) => b.fitness - a.fitness);
            const winner = sortedParticipants[0];
            return winner;
        }

        function recombination(parentA, parentB) {
            let childPhrase = "";

            for(let i = 0; i < INDIVIDUAL_SIZE; i++) {
            
                const randomNumber = Math.random();
                if(randomNumber > 0.5) {
                    childPhrase += parentA.phrase[i];
                } else {
                    childPhrase += parentB.phrase[i];
                }
            }
            
            return childPhrase;
        }

        function mutation() {

        }

        //

        createPopulation(POPULATION_SIZE);

        testPopulation();

        selection();

    </script>
</body>
</html>